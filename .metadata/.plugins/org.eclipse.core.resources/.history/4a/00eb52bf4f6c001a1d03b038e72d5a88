//package dk.klevang.ui.hover
//
//import org.eclipse.emf.ecore.EObject
//import org.eclipse.xtext.ui.editor.hover.html.DefaultEObjectHoverProvider
//
//class MyHoverClass extends DefaultEObjectHoverProvider {
//	
//	override getFirstLine(EObject o)
//	{
//		System.out.println("Something!")
//		return "Hej med dig!"
//	}
//	
//}



package dk.klevang.ui.hover

import org.eclipse.emf.ecore.EObject
import org.eclipse.xtext.ui.editor.hover.html.DefaultEObjectHoverProvider
import dk.klevang.mathInterpreter.Exp
import com.google.inject.Inject
import dk.klevang.generator.MathInterpreterGenerator
import dk.klevang.mathInterpreter.MathExp
import dk.klevang.mathInterpreter.Plus
import dk.klevang.mathInterpreter.Minus
import dk.klevang.mathInterpreter.Mult
import dk.klevang.mathInterpreter.Div

class MyHoverClass extends DefaultEObjectHoverProvider {
	
	@Inject extension MathInterpreterGenerator
	override getHoverInfoAsHtml(EObject o) {
//		if (o instanceof Exp) {
//			val exp = o as Exp
//			return '''
//			<p>
//			type: <b>int</b> <br>
//			value: <b>첿xp.computeExp(null)</b
//			</p>
//			'''
//		}
//		else
//		{
//			return super.getHoverInfoAsHtml(o)
//		}
		
		switch o {
			Exp: handleExp(o)
			default: return super.getHoverInfoAsHtml(o)
		}
	}
	
	
	def handleExp(Exp exp)
	{
		if (exp.getExpVar === null)
		{	
			return '''
			<p>
			type: <b>int</b> <br>
			value: <b>첿xp.computeExp(null)</b
			</p>
			'''
		}
		else
		{
			try
			{
				var math = exp.eContainer as MathExp
				while (math.eContainer !== null)
				{
					math = math.eContainer as MathExp
				}
				return '''
				<p>
				type: <b>int</b> <br>
				value: <b>쳋ath.compute</b
				</p>
				'''
			}
			catch (ClassCastException exception)
			{
				return '''
				<p>
				type: <b>int</b> <br>
				value: <b>첿xp.handleOperator</b
				</p>
				'''
			}
	
		}
		
	}
	
	def handleOperator(Exp exp)
	{
		//val parent = exp.eContainer as Exp
		return exp.computeExp(null)
//		switch exp {
//			Plus: handleOperator(parent)
//			Minus: handleOperator(parent)
//			Mult: handleOperator(parent)
//			Div: handleOperator(parent)
//			default: exp.computeExp(null)
//		}
	}
	
}